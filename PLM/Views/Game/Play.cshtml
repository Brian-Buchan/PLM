@model PLM.PlayViewModel
@{
    ViewBag.Title = "Play";
}
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Play Game</title>
    <link href="~/Content/bootstrap.min.css" rel="stylesheet">
    <link href="~/Content/font-awesome.min.css" rel="stylesheet">
    <link href="~/Content/animate.min.css" rel="stylesheet">
    <link href="~/Content/lightbox.css" rel="stylesheet">
    <link href="~/Content/main.css" rel="stylesheet">
    <link href="~/Content/responsive.css" rel="stylesheet">
    <link href="~/Content/test.css" rel="stylesheet">
    <script type="text/javascript" src="~/Scripts/moment.js"></script>
    <script type="text/javascript">
        //function startCountdown(time) {
        //    var dur = moment.duration(time);
        //    setInterval(function() {
        //        dur = dur.subtract(1,'s');
        //        $('#clockdiv').text(
        //            ('0' + dur.hours()).slice(-2) + ':'
        //            + ('0' + dur.minutes()).slice(-2) + ':'
        //            + ('0' + dur.seconds()).slice(-2)
        //            );
        //        if (dur.hours() == 0 & dur.minutes() == 0 & dur.seconds() == 0) {
        //            document.getElementById("GameForm").submit();
        //        }
        //    }, 1000);
        //}
    </script>

</head>
<body onload="startCountdown('@Model.Time.ToString()')">
    <audio id="audioCorrect" preload="auto">
        <source src="~/Content/Audio/correctSound.mp3" type="audio/mp3" />
    </audio>
    <audio id="audioIncorrect" preload="auto">
        <source src="~/Content/Audio/incorrectSound.mp3" type="audio/mp3" />
    </audio>

    <div id="gameBoard">
        <div id="ScoreBoard">
            <p>Score:</p>
            <p id="displayScore">@Model.Score</p>
            <br/>
            <br />
            <p>Time Left:</p>
            <p><div id="clockdiv">@Model.Time.ToString()</div></p>
            
        </div>

        <img onerror="this.src='/Content/images/Error.bmp';" id="picture" src="@Model.ImageURL" title="Image Courtesy of @Model.Attribution" />
        <p id="StoredAnswer" hidden="hidden">@Model.Answer</p>

        <div>
            <div id="answerButtons">
                @for (int i = 0; i < Model.possibleAnswers.Count; i++)
                {
                    @*the javascript "this" keyword is used in the function call to refer to the sender, instead of an id.*@
                    <button class="btn btn-primary gameButton" onclick="ButtonClick(this.textContent)">@Model.possibleAnswers.ElementAt(i)</button>
                }
            </div>
        </div>
        <br />
        <div id="Attribution">
            <p>@Model.Attribution</p>
        </div>
        <br />
        @using (Html.BeginForm("Play", "Game", FormMethod.Post, new {id = "GameForm", onsubmit = "return CheckIn();" }))
        {
            <input id="Score" name="Score" hidden="hidden" type="number" value="@Model.Score" />
            <input id="Time" name="Time" hidden="hidden" type="text" value="@Model.Time.ToString()" />
            <div id="nextButton" style="display:none;">
                <button id="next" type="submit" value="">Next</button>
                <h1 id="resultText">Correct</h1>
            </div>
        }
        <br />
        <br />
        <button onclick="ToggleMute()">Mute/Unmute</button>
        <script type="text/javascript" src="~/Scripts/gameplay.js"></script>
    </div>
</body>
